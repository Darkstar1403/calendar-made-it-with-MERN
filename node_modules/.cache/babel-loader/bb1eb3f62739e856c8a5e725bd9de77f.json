{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Branco/Desktop/React/react-09-calendar-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Branco/Desktop/React/react-09-calendar-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Swal from\"sweetalert2\";import{fetchWithoutToken,fetchWithToken}from\"../helpers/fetch\";import{types}from\"../types/types\";export var startLogin=function startLogin(email,password){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var resp,body;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchWithoutToken('auth',{email:email,password:password},'POST');case 2:resp=_context.sent;_context.next=5;return resp.json();case 5:body=_context.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{Swal.fire('Error',body.msg,'error');}case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var startRegister=function startRegister(email,name,password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var resp,body;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchWithoutToken('auth/register',{name:name,email:email,password:password},'POST');case 2:resp=_context2.sent;_context2.next=5;return resp.json();case 5:body=_context2.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{Swal.fire('Error',body.msg,'error');}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var startChecking=function startChecking(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var resp,body;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchWithToken('auth/renew');case 2:resp=_context3.sent;_context3.next=5;return resp.json();case 5:body=_context3.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{dispatch(checkingFinish());}case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var checkingFinish=function checkingFinish(){return{type:types.authCheckingFinish};};var login=function login(user){return{type:types.authLogin,payload:user};};export var startLogout=function startLogout(){return function(dispatch){localStorage.clear();dispatch(logout());};};var logout=function logout(){return{type:types.authLogout};};","map":{"version":3,"sources":["C:/Users/Branco/Desktop/React/react-09-calendar-app/src/actions/auth.js"],"names":["Swal","fetchWithoutToken","fetchWithToken","types","startLogin","email","password","dispatch","resp","json","body","ok","localStorage","setItem","token","Date","getTime","login","uid","name","fire","msg","startRegister","startChecking","checkingFinish","type","authCheckingFinish","user","authLogin","payload","startLogout","clear","logout","authLogout"],"mappings":"iVAAA,MAAOA,CAAAA,IAAP,KAAiB,aAAjB,CACA,OAASC,iBAAT,CAA4BC,cAA5B,KAAkD,kBAAlD,CACA,OAASC,KAAT,KAAsB,gBAAtB,CAEA,MAAO,IAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,KAAD,CAAQC,QAAR,CAAoB,CAC1C,+FAAO,iBAAMC,QAAN,sJACgBN,CAAAA,iBAAiB,CAAC,MAAD,CAAS,CAACI,KAAK,CAALA,KAAD,CAAQC,QAAQ,CAARA,QAAR,CAAT,CAA4B,MAA5B,CADjC,QACGE,IADH,qCAEgBA,CAAAA,IAAI,CAACC,IAAL,EAFhB,QAEGC,IAFH,eAGH,GAAGA,IAAI,CAACC,EAAR,CAAW,CACPC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,IAAI,CAACI,KAAnC,EACAF,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAAwC,GAAIE,CAAAA,IAAJ,GAAWC,OAAX,EAAxC,EAEAT,QAAQ,CAACU,KAAK,CAAC,CACXC,GAAG,CAAER,IAAI,CAACQ,GADC,CAEXC,IAAI,CAAET,IAAI,CAACS,IAFA,CAAD,CAAN,CAAR,CAIH,CARD,IASI,CACAnB,IAAI,CAACoB,IAAL,CAAU,OAAV,CAAmBV,IAAI,CAACW,GAAxB,CAA6B,OAA7B,EACH,CAdE,sDAAP,+DAgBH,CAjBM,CAmBP,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACjB,KAAD,CAAQc,IAAR,CAAcb,QAAd,CAA0B,CACnD,gGAAO,kBAAMC,QAAN,2JACgBN,CAAAA,iBAAiB,CAAC,eAAD,CAAkB,CAACkB,IAAI,CAAJA,IAAD,CAAOd,KAAK,CAALA,KAAP,CAAcC,QAAQ,CAARA,QAAd,CAAlB,CAA2C,MAA3C,CADjC,QACGE,IADH,uCAEgBA,CAAAA,IAAI,CAACC,IAAL,EAFhB,QAEGC,IAFH,gBAGH,GAAGA,IAAI,CAACC,EAAR,CAAW,CACPC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,IAAI,CAACI,KAAnC,EACAF,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAAwC,GAAIE,CAAAA,IAAJ,GAAWC,OAAX,EAAxC,EAEAT,QAAQ,CAACU,KAAK,CAAC,CACXC,GAAG,CAAER,IAAI,CAACQ,GADC,CAEXC,IAAI,CAAET,IAAI,CAACS,IAFA,CAAD,CAAN,CAAR,CAIH,CARD,IASI,CACAnB,IAAI,CAACoB,IAAL,CAAU,OAAV,CAAmBV,IAAI,CAACW,GAAxB,CAA6B,OAA7B,EACH,CAdE,wDAAP,iEAgBH,CAjBM,CAmBP,MAAO,IAAME,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAK,CAC9B,gGAAO,kBAAMhB,QAAN,2JACgBL,CAAAA,cAAc,CAAC,YAAD,CAD9B,QACGM,IADH,uCAEgBA,CAAAA,IAAI,CAACC,IAAL,EAFhB,QAEGC,IAFH,gBAGH,GAAGA,IAAI,CAACC,EAAR,CAAW,CACPC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BH,IAAI,CAACI,KAAnC,EACAF,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAAwC,GAAIE,CAAAA,IAAJ,GAAWC,OAAX,EAAxC,EAEAT,QAAQ,CAACU,KAAK,CAAC,CACXC,GAAG,CAAER,IAAI,CAACQ,GADC,CAEXC,IAAI,CAAET,IAAI,CAACS,IAFA,CAAD,CAAN,CAAR,CAIH,CARD,IASI,CACAZ,QAAQ,CAACiB,cAAc,EAAf,CAAR,CACH,CAdE,wDAAP,iEAgBH,CAjBM,CAmBP,GAAMA,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,SAAM,CAACC,IAAI,CAAEtB,KAAK,CAACuB,kBAAb,CAAN,EAAvB,CAEA,GAAMT,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACU,IAAD,QAAU,CACpBF,IAAI,CAAEtB,KAAK,CAACyB,SADQ,CAEpBC,OAAO,CAAEF,IAFW,CAAV,EAAd,CAKA,MAAO,IAAMG,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAK,CAC5B,MAAO,UAACvB,QAAD,CAAa,CAChBK,YAAY,CAACmB,KAAb,GACAxB,QAAQ,CAACyB,MAAM,EAAP,CAAR,CACH,CAHD,CAIH,CALM,CAOP,GAAMA,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,SAAO,CAACP,IAAI,CAACtB,KAAK,CAAC8B,UAAZ,CAAP,EAAf","sourcesContent":["import Swal from \"sweetalert2\";\r\nimport { fetchWithoutToken, fetchWithToken } from \"../helpers/fetch\"\r\nimport { types } from \"../types/types\";\r\n\r\nexport const startLogin = (email, password) =>{\r\n    return async(dispatch) =>{\r\n        const resp = await fetchWithoutToken('auth', {email, password}, 'POST');\r\n        const body = await resp.json();\r\n        if(body.ok){\r\n            localStorage.setItem('token', body.token);\r\n            localStorage.setItem('token-init-date', new Date().getTime());\r\n\r\n            dispatch(login({\r\n                uid: body.uid,\r\n                name: body.name\r\n            }));\r\n        }\r\n        else{\r\n            Swal.fire('Error', body.msg, 'error');\r\n        }\r\n    }\r\n};\r\n\r\nexport const startRegister = (email, name, password) =>{\r\n    return async(dispatch) =>{\r\n        const resp = await fetchWithoutToken('auth/register', {name, email, password}, 'POST');\r\n        const body = await resp.json();\r\n        if(body.ok){\r\n            localStorage.setItem('token', body.token);\r\n            localStorage.setItem('token-init-date', new Date().getTime());\r\n\r\n            dispatch(login({\r\n                uid: body.uid,\r\n                name: body.name\r\n            }));\r\n        }\r\n        else{\r\n            Swal.fire('Error', body.msg, 'error');\r\n        }\r\n    }\r\n}\r\n\r\nexport const startChecking = () =>{\r\n    return async(dispatch) =>{\r\n        const resp = await fetchWithToken('auth/renew');\r\n        const body = await resp.json();\r\n        if(body.ok){\r\n            localStorage.setItem('token', body.token);\r\n            localStorage.setItem('token-init-date', new Date().getTime());\r\n\r\n            dispatch(login({\r\n                uid: body.uid,\r\n                name: body.name\r\n            }));\r\n        }\r\n        else{\r\n            dispatch(checkingFinish());\r\n        }\r\n    }\r\n}\r\n\r\nconst checkingFinish = () =>({type: types.authCheckingFinish});\r\n\r\nconst login = (user) =>({\r\n    type: types.authLogin,\r\n    payload: user\r\n});\r\n\r\nexport const startLogout = () =>{\r\n    return (dispatch) =>{\r\n        localStorage.clear();\r\n        dispatch(logout());\r\n    }\r\n}\r\n\r\nconst logout = () => ({type:types.authLogout});"]},"metadata":{},"sourceType":"module"}